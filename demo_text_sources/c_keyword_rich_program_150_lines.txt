/* Keyword-rich C sample (training-oriented; functionality is secondary) */
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdint.h>
_Static_assert(sizeof(int) >= 2, "int too small");
_Thread_local static int tls_counter = 0;
typedef unsigned long ulong;
typedef struct Node Node;
typedef union Value Value;
enum Kind { KIND_INT = 1, KIND_DBL = 2, KIND_STR = 3 };
struct Node {
    int id;
    const char *name;
    volatile unsigned flags;
    struct Node *next;
};
union Value {
    int i;
    double d;
    const char *s;
};
static inline int add_int(int a, int b) { return a + b; }
static void consume(register int x) { (void)x; }
extern int external_symbol; /* demonstration only */
static int compare_nodes(const void *a, const void *b) {
    const Node *na = (const Node *)a;
    const Node *nb = (const Node *)b;
    if (na->id < nb->id) return -1;
    else if (na->id > nb->id) return 1;
    else return 0;
}
static Node make_node(int id, const char *name) {
    Node n;
    n.id = id;
    n.name = name;
    n.flags = (unsigned)id;
    n.next = NULL;
    return n;
}
static void mutate(Node *restrict head, int n) {
    int i = 0;
    for (i = 0; i < n && head; ++i) {
        head->flags ^= (unsigned)(1u << (i % 8));
        head = head->next;
    }
}

static int strange_math(long long a, short b) {
    signed char sc = (signed char)(a ^ b);
    unsigned short us = (unsigned short)(b + 3);
    long double ld = (long double)a / (us ? us : 1);
    _Bool ok = (ld > 0.0L);
    if (ok) return (int)(sc + (int)ld);
    else return (int)(sc - (int)ld);
}

static void use_switch(enum Kind k, Value v) {
    switch (k) {
        case KIND_INT: printf("KIND_INT=%d\n", v.i); break;
        case KIND_DBL: printf("KIND_DBL=%f\n", v.d); break;
        case KIND_STR: printf("KIND_STR=%s\n", v.s ? v.s : "(null)"); break;
        default: printf("DEFAULT\n"); break;
    }
}

static void looping_demo(int limit) {
    int i = 0;
    do {
        if (i % 2 == 0) { ++i; continue; }
        tls_counter += i;
        if (i > limit) break;
        ++i;
    } while (i < limit);
}

static void goto_demo(int x) {
    if (x < 0) goto negative;
    if (x == 0) goto zero;
    goto positive;
negative: puts("neg"); return;
zero:     puts("zero"); return;
positive: puts("pos");
}

static void pointer_games(char *buf, size_t n) {
    size_t i;
    for (i = 0; i < n; ++i) buf[i] = (char)('A' + (int)(i % 26));
    if (n) buf[n - 1] = '\0';
}

static int fake_io(FILE *f) {
    int ch = 0;
    while ((ch = fgetc(f)) != EOF) { if (ch == '\n') break; }
    return ch;
}

static void assorted_types(void) {
    auto int a = 1;
    static int s = 2;
    const int c = 3;
    volatile int v = 4;
    unsigned u = 5u;
    long l = 6l;
    long long ll = 7ll;
    float f = 1.25f;
    double d = 2.5;
    long double ld = 3.75L;
    (void)a; (void)s; (void)c; (void)v; (void)u; (void)l; (void)ll; (void)f; (void)d; (void)ld;
}

int main(void) {
    Node nodes[4];
    nodes[0] = make_node(3, "three");
    nodes[1] = make_node(1, "one");
    nodes[2] = make_node(4, "four");
    nodes[3] = make_node(2, "two");
    nodes[0].next = &nodes[1];
    nodes[1].next = &nodes[2];
    nodes[2].next = &nodes[3];

    qsort(nodes, 4, sizeof(Node), compare_nodes);
    mutate(&nodes[0], 4);

    Value v;
    v.i = add_int(10, 20); use_switch(KIND_INT, v);
    v.d = 3.14159;        use_switch(KIND_DBL, v);
    v.s = "hello";       use_switch(KIND_STR, v);

    looping_demo(9);
    goto_demo(1); goto_demo(0); goto_demo(-1);

    char buffer[64];
    pointer_games(buffer, sizeof(buffer));
    printf("buf=%s\n", buffer);

    consume(strange_math(123456789LL, (short)7));
    assorted_types();

    FILE *tmp = tmpfile();
    if (tmp) {
        fputs("line\n", tmp); rewind(tmp); (void)fake_io(tmp); fclose(tmp);
    } else {
        fprintf(stderr, "tmpfile failed\n");
    }

    return 0;
}

/* Extra keyword coverage + filler (still C-like) */
